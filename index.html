<!DOCTYPE html>
<html>
<head>
	<title>Vid Scraper</title>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<link rel="stylesheet" type="text/css" href="./stylesheet.css">
</head>
<body>

<h1>Video Web Scraper</h1>

<p class="error">Type in a keyword</p>
<div class="search-form">
	<input type="text" id="keyword" placeholder="keyword">
	<button>Search</button>
</div>

<div class="videos"></div>

<script>
const error = document.querySelector(".error");
const input = document.querySelector("input");
const button = document.querySelector("button");
const videos = document.querySelector(".videos");
let interval;

document.querySelector("button").addEventListener("click", () => {
	
	if (input.value == "") {
		error.style.visibility = "visible";
		return;
	}
	else {
		error.style.visibility = "hidden";
	}
	button.disabled = true;
	let searching = ["Searching.", "Searching..", "Searching..."];
	let i = 0;
	interval = setInterval(() => {
		button.textContent = searching[i];
		i === 2 ? i = 0 : i++;
	}, 200)

	axios.post("/", {
		keyword: input.value
	})
	.then(function(res){
		res.data.forEach(vid => {
			for (let v of vid) {
				let videoTag = document.createElement("video");
				videos.appendChild(videoTag);
				videoTag.outerHTML = `<video width="720" height="404" controls>
				<source src="${v}"></video>`;
			}
		})
		resetButton();
	})
	.catch(() => {
		resetButton();
	})
})

function resetButton() {
	clearInterval(interval);
	button.textContent = "Search";
	button.disabled = false;
}
</script>

</body>
</html>